# MorphlingNews（新冠肺炎疫情 APP）

###    2018011351 计83 何雨泽               2018011114 计83 陈祖浩



### 1. 基础功能


| **功能** |        子功能         | 总占比(%)（功能+性能） | 是否实现 |
| :------: | :----------------------------------------------------------: | :-----------------: | :------: |
| 系统支持 |    要保证程序在安卓机上正常运行，测试过程中程序不崩溃。    | 8+2                 | √        |
| 页面布局 |                   布局合理，点击处理正确                    | 8+2                 | √        |
| 新闻列表 |                        删除和添加操作                        | 4+1                 | √        |
|          | 正确显示新闻列表的消息，布局和展示，点击进入新闻详情页面正确 | 8+2                 | √        |
|          | 实现新闻的本地存储，看过的新闻列表 在离线的情况下也可以浏览。新闻是否看过的页面灰色标记。 | 8+2                 | √        |
|          | 上拉获取更多新闻，下拉刷新最新新闻 | 4+1                 | √        |
|          | 显示新闻的来源和时间 | 4+1                 | √        |
| | 新闻关键词搜索，历史记录 | 4+1 | √ |
| 分享收藏 | 使用微博等 SDK分享，新闻详情页面点击分享可以分享到常用的 app，分享内容带有新闻摘要 | 4+1 | √ |
| 疫情数据 | 全国各省疫情统计，全球各国疫情统计可视化，以表格或折线图或柱状图形式呈现 | 8+2 | √ |
| 疫情图谱 | 对新冠疫情图谱内容进行查询和展示，需展示实体词条的描述，包含的关系和属性 | 8+2 | √ |



### 2. 扩展功能

|   **功能**    |                       子功能                       | 总占比(%)（功能+性能） | 是否实现 |
| :-----------: | :------------------------------------------------: | :--------------------: | :------: |
| 疫情新闻 聚类 | 对疫情相关的新闻事件进行聚类、展示关键词和聚类新闻 |          8+2           |    √     |
|   知疫学者    | 显示在疫情领域的高关注学者和追忆学者，点开可以查看 |          4+1           |    √     |



### 4. 后端介绍

#### 4.0 整体架构

​		从今年大作业的需求来看，APP仅仅通过HTTP请求就可以完成所有的网络交互，也没有大规模的数据需要处理（整个新闻列表文件大概只有20M左右），因此不需要特地实现服务端，所以后端只需要在本地对数据进行处理即可，当然多线程是有必要的，在APP中也有被大量运用。

​		本地端中，我选择以一个单例**InfoManager类**作为中枢，为前端提供必要的数据接口，同时也实现了各种基本的数据处理操作。对于一些复杂的数据处理，则放在其他不暴露给前端的类中实现，例如**Kmeans类**主要实现聚类算法，**NewsDictionary类**保存了关键词的倒排索引和出现在文章的频率，为新闻搜索接口提供支持。

#### 4.1 疫情数据 & 新闻数据

##### 4.1.1 数据拉取

​		疫情数据和新闻数据都可以通过GET请求由给定的接口直接获得，由于请求得到的均为JSON字符串，因此我们需要对其进行解析。这里我们选择了Fastjson这一Java库来进行JSON解析，主要是用到了JSONObject和JSONArray两个类分别来处理**字典**和**列表**，通过反复迭代来爬取需要的信息，其中新闻类信息被封装在了**NewsData类**，而疫情数据信息被封装在了**InfectData类**中。**InfoManager类**对前端提供了getNewsData和getInfectData两个接口用于获取数据，还提供了

##### 4.1.2 离线存储

​		我们认为新闻数据和疫情数据是APP中最重要的数据，因此有必要让用户在离线情况下也能访问，所以实现了这两类数据的离线存储（当然作业需求中也要求能离线访问新闻列表），这里我们选择在本地存储JSON串的方式来进行离线存储

​		当用户打开APP时，无论联网与否，都会优先读取本地的JSON文件，然后系统才会在后台更新这两类信息的最新数据，同时将更新的数据保存至本地——这样保证了用户在使用过程中不会在开启程序界面等待太久，提高了用户体验。

##### 4.1.3 新闻搜索

​		我们实现了对新闻标题的排序搜索功能，使用了Java版的Jieba(https://github.com/huaban/jieba-analysis) 对标题和搜索关键词进行分词，根据搜索关键词的倒排索引定位到若干篇文章，再计算每种关键词对于每篇相关文章的TF-IDF值，加权求和后按权值由大到小排序并展示。

​		上述倒排索引以及词频字典都存储在**NewsDictionary类**中，这些数据会在新闻数据刷新后在后台刷新（因此搜索功能在最新新闻方面相比新闻列表呈现的有一定时间滞后）

#### 4.2 知识图谱 & 知疫专家

​		这两类数据的拉取方式和疫情信息和新闻信息完全一致，只不过内容更多更复杂一些。前端可以通过**InfoManager类**的getKnowledge和getScholarData两个接口获得数据。这两类数据并不会被离线保存在本地，而是实时访问和实时加载的，因此在离线情况下无法正确被加载。

#### 4.3 新闻聚类

​		新闻的聚类使用的是KMess



#### 4.4 一些优化



### 5.总结与心得

